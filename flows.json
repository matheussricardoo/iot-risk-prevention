[
    {
        "id": "fire_detection_tab",
        "type": "tab",
        "label": "ğŸ”¥ DetecÃ§Ã£o de Queimadas - Multi-Estado",
        "disabled": false,
        "info": "Sistema IoT de DetecÃ§Ã£o e PrevenÃ§Ã£o de Queimadas\n\n**Estados Monitorados:**\n- ğŸŒ³ Amazonas (Manaus)\n- ğŸŒ¾ Mato Grosso do Sul (Campo Grande)\n- â›°ï¸ Minas Gerais (Belo Horizonte)\n\n**Fontes de Dados:**\n- ESP32 Wokwi (Simulado) via MQTT\n- API (Dados Reais) via Inject\n\n**SaÃ­das:**\n- InfluxDB Cloud\n- WhatsApp\n- Grafana Cloud (via InfluxDB)"
    },
    {
        "id": "comment_entrada",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ“¥ ENTRADA - Dados dos Sensores (ESP32 Wokwi + API)",
        "info": "Recebe dados de 2 fontes:\n- ESP32 Wokwi (simulado via MQTT)\n- API (dados reais via inject)",
        "x": 200,
        "y": 60,
        "wires": []
    },
    {
        "id": "mqtt_wokwi",
        "type": "mqtt in",
        "z": "fire_detection_tab",
        "name": "ğŸ“¡ Wokwi (ESP32)",
        "topic": "iot/fire-detection/esp32-wokwi",
        "qos": "0",
        "datatype": "json",
        "broker": "mqtt_broker_hivemq",
        "inputs": 0,
        "x": 130,
        "y": 120,
        "wires": [["parse_json_wokwi"]]
    },
    {
        "id": "parse_json_wokwi",
        "type": "json",
        "z": "fire_detection_tab",
        "name": "ğŸ“‹ Parse JSON",
        "property": "payload",
        "action": "obj",
        "x": 310,
        "y": 120,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "save_sensor_data",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ’¾ Salvar Dados Sensor",
        "func": "// Salvar dados do sensor em contexto global para uso posterior\nglobal.set('sensorData', {\n    device: msg.payload.device || 'esp32-wokwi',\n    temperature: parseFloat(msg.payload.temperature) || 0,\n    humidity: parseFloat(msg.payload.humidity) || 0,\n    smoke: parseFloat(msg.payload.smoke) || 0,\n    alert: msg.payload.alert || false,\n    timestamp: new Date().toISOString()\n});\n\nnode.status({fill:\"green\", shape:\"dot\", text:`${msg.payload.device}: Temp=${msg.payload.temperature}Â°C`});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 510,
        "y": 120,
        "wires": [["trigger_states"]]
    },
    {
        "id": "trigger_states",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸŒ Distribuir para Estados",
        "func": "// Cria 3 mensagens, uma para cada estado\nconst states = [\n    { city: \"Manaus\", state: \"Amazonas\", abbr: \"AM\", country: \"Brazil\" },\n    { city: \"Campo Grande\", state: \"Mato Grosso do Sul\", abbr: \"MS\", country: \"Brazil\" },\n    { city: \"Belo Horizonte\", state: \"Minas Gerais\", abbr: \"MG\", country: \"Brazil\" }\n];\n\nconst messages = states.map(location => {\n    return {\n        payload: msg.payload,\n        location: location\n    };\n});\n\nreturn [messages];",
        "outputs": 1,
        "noerr": 0,
        "x": 730,
        "y": 120,
        "wires": [["split_states"]]
    },
    {
        "id": "split_states",
        "type": "split",
        "z": "fire_detection_tab",
        "name": "ğŸ”€ Split Estados",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 920,
        "y": 120,
        "wires": [["route_to_weather"]]
    },
    {
        "id": "comment_clima",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸŒ¦ï¸ CLIMA - OpenWeather API (Dados Reais)",
        "info": "Coleta dados meteorolÃ³gicos reais de cada estado",
        "x": 210,
        "y": 200,
        "wires": []
    },
    {
        "id": "route_to_weather",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ™ï¸ Rotear para Estado Correto",
        "func": "// Rotear para o nÃ³ OpenWeather correto baseado na localizaÃ§Ã£o\nconst city = msg.location.city;\n\nnode.status({fill:\"blue\", shape:\"ring\", text:`Roteando ${city}...`});\n\n// Retorna null para as saÃ­das que nÃ£o correspondem Ã  cidade\n// SaÃ­da 1: Manaus (AM)\n// SaÃ­da 2: Campo Grande (MS)\n// SaÃ­da 3: Belo Horizonte (MG)\n\nif (city === \"Manaus\") {\n    return [msg, null, null];\n} else if (city === \"Campo Grande\") {\n    return [null, msg, null];\n} else if (city === \"Belo Horizonte\") {\n    return [null, null, msg];\n}\n\n// Fallback: se nÃ£o reconhecer a cidade, nÃ£o envia para nenhum\nnode.error(`Cidade desconhecida: ${city}`);\nreturn [null, null, null];",
        "outputs": 3,
        "noerr": 0,
        "x": 180,
        "y": 280,
        "wires": [["weather_amazonas"], ["weather_ms"], ["weather_mg"]]
    },
    {
        "id": "weather_amazonas",
        "type": "openweathermap",
        "z": "fire_detection_tab",
        "name": "ğŸŒ³ Amazonas (Manaus)",
        "wtype": "current",
        "lon": "",
        "lat": "",
        "city": "Manaus",
        "country": "Brazil",
        "language": "pt",
        "x": 460,
        "y": 240,
        "wires": [["analyze_fire_risk"]]
    },
    {
        "id": "weather_ms",
        "type": "openweathermap",
        "z": "fire_detection_tab",
        "name": "ğŸŒ¾ MS (Campo Grande)",
        "wtype": "current",
        "lon": "",
        "lat": "",
        "city": "Campo Grande",
        "country": "Brazil",
        "language": "pt",
        "x": 470,
        "y": 280,
        "wires": [["analyze_fire_risk"]]
    },
    {
        "id": "weather_mg",
        "type": "openweathermap",
        "z": "fire_detection_tab",
        "name": "â›°ï¸ MG (Belo Horizonte)",
        "wtype": "current",
        "lon": "",
        "lat": "",
        "city": "Belo Horizonte",
        "country": "Brazil",
        "language": "pt",
        "x": 480,
        "y": 320,
        "wires": [["analyze_fire_risk"]]
    },
    {
        "id": "comment_analise",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ”¥ ANÃLISE - Algoritmo de Risco de Queimada",
        "info": "Combina dados do sensor + clima para calcular risco",
        "x": 220,
        "y": 380,
        "wires": []
    },
    {
        "id": "analyze_fire_risk",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ”¥ Calcular Risco de Queimada",
        "func": "// Recuperar dados do sensor\nconst sensor = global.get('sensorData') || {\n    temperature: 25,\n    humidity: 50,\n    smoke: 100,\n    device: 'esp32-wokwi'\n};\n\n// Extrair dados meteorolÃ³gicos\nconst weather = msg.payload;\nconst extTemp = parseFloat(weather.tempc) || 25;\nconst extHumidity = parseFloat(weather.humidity) || 50;\nconst windSpeed = parseFloat(weather.windspeed) || 0;\nconst conditions = weather.description || 'desconhecido';\n\n// âš ï¸ CRÃTICO: Preservar msg.location que vem do nÃ³ trigger_states\n// Se msg.location existe, usar direto (vem do split_states)\n// Caso contrÃ¡rio, tentar inferir do payload OpenWeather (fallback)\nlet location;\nif (msg.location && msg.location.abbr) {\n    // âœ… LocalizaÃ§Ã£o jÃ¡ estÃ¡ correta do flow anterior\n    location = msg.location;\n} else {\n    // âš ï¸ Fallback: tentar extrair do nome da cidade no OpenWeather\n    const cityName = weather.location || '';\n    if (cityName.includes('Manaus')) {\n        location = { city: 'Manaus', state: 'Amazonas', abbr: 'AM', country: 'Brazil' };\n    } else if (cityName.includes('Campo Grande')) {\n        location = { city: 'Campo Grande', state: 'Mato Grosso do Sul', abbr: 'MS', country: 'Brazil' };\n    } else if (cityName.includes('Belo Horizonte')) {\n        location = { city: 'Belo Horizonte', state: 'Minas Gerais', abbr: 'MG', country: 'Brazil' };\n    } else {\n        // âŒ Ãšltimo recurso: inferir da cidade do weather se possÃ­vel\n        node.warn(`âš ï¸ LocalizaÃ§Ã£o nÃ£o encontrada! weather.location=${cityName}`);\n        location = { city: cityName || 'Desconhecido', state: 'N/A', abbr: 'XX', country: 'Brazil' };\n    }\n}\n\n// ==========================================\n// ALGORITMO DE RISCO DE QUEIMADA\n// ==========================================\nlet riskScore = 0;\nlet riskLevel = 'BAIXO';\nlet riskColor = 'ğŸŸ¢';\n\n// 1. ANÃLISE DE FUMAÃ‡A (peso: 40%)\nif (sensor.smoke > 600) riskScore += 40;\nelse if (sensor.smoke > 400) riskScore += 30;\nelse if (sensor.smoke > 200) riskScore += 15;\n\n// 2. ANÃLISE DE TEMPERATURA INTERNA (peso: 25%)\nif (sensor.temperature > 50) riskScore += 25;\nelse if (sensor.temperature > 40) riskScore += 20;\nelse if (sensor.temperature > 35) riskScore += 10;\n\n// 3. ANÃLISE DE TEMPERATURA EXTERNA (peso: 15%)\nif (extTemp > 35) riskScore += 15;\nelse if (extTemp > 30) riskScore += 10;\nelse if (extTemp > 25) riskScore += 5;\n\n// 4. ANÃLISE DE UMIDADE (peso: 10%)\nconst avgHumidity = (sensor.humidity + extHumidity) / 2;\nif (avgHumidity < 30) riskScore += 10;\nelse if (avgHumidity < 50) riskScore += 5;\n\n// 5. ANÃLISE DE VENTO (peso: 10%)\nif (windSpeed > 40) riskScore += 10;\nelse if (windSpeed > 20) riskScore += 5;\n\n// Determinar nÃ­vel de risco\nif (riskScore >= 70) {\n    riskLevel = 'CRÃTICO';\n    riskColor = 'ğŸ”´';\n} else if (riskScore >= 50) {\n    riskLevel = 'ALTO';\n    riskColor = 'ğŸŸ ';\n} else if (riskScore >= 30) {\n    riskLevel = 'MÃ‰DIO';\n    riskColor = 'ğŸŸ¡';\n} else {\n    riskLevel = 'BAIXO';\n    riskColor = 'ğŸŸ¢';\n}\n\nconst timestamp = new Date();\n\n// Montar payload completo\nmsg.payload = {\n    sensor: {\n        device: sensor.device,\n        temperature: sensor.temperature,\n        humidity: sensor.humidity,\n        smoke: sensor.smoke\n    },\n    weather: {\n        temperature: extTemp,\n        humidity: extHumidity,\n        windSpeed: windSpeed,\n        conditions: conditions\n    },\n    location: location,\n    risk: {\n        score: riskScore,\n        level: riskLevel,\n        color: riskColor,\n        shouldAlert: riskScore >= 50\n    },\n    timestamp: timestamp.toISOString()\n};\n\nnode.status({\n    fill: riskScore >= 70 ? \"red\" : riskScore >= 50 ? \"yellow\" : \"green\",\n    shape: \"dot\",\n    text: `${sensor.device}/${location.abbr}: ${riskLevel} (${riskScore})`\n});\n\n// SaÃ­da 1: Sempre envia para InfluxDB\n// SaÃ­da 2: SÃ³ envia para WhatsApp se risco >= 50\nif (msg.payload.risk.shouldAlert) {\n    return [msg, msg];\n} else {\n    return [msg, null];\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 740,
        "y": 440,
        "wires": [
            ["format_influxdb", "debug_analysis"],
            ["format_whatsapp"]
        ]
    },
    {
        "id": "comment_saidas",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ’¾ SAÃDAS - InfluxDB Cloud + WhatsApp + Grafana",
        "info": "Armazena dados na nuvem e envia alertas",
        "x": 220,
        "y": 520,
        "wires": []
    },
    {
        "id": "format_influxdb",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ—„ï¸ Formatar para InfluxDB 2.0",
        "func": "const data = msg.payload;\n\n// Sanitizar e converter todos os valores numÃ©ricos\nconst sensor_temp = Number(data.sensor.temperature) || 0;\nconst sensor_humidity = Number(data.sensor.humidity) || 0;\nconst sensor_smoke = Number(data.sensor.smoke) || 0;\nconst weather_temp = Number(data.weather.temperature) || 0;\nconst weather_humidity = Number(data.weather.humidity) || 0;\nconst weather_wind = Number(data.weather.windSpeed) || 0;\nconst risk_score = Number(data.risk.score) || 0;\n\n// Tags (strings)\nconst device = String(data.sensor.device || 'unknown');\nconst location = String(data.location.city || 'unknown');\nconst state = String(data.location.abbr || 'XX');\nconst region = String(data.location.state || 'unknown');\nconst risk_level = String(data.risk.level || 'N/A');\nconst alert = data.risk.shouldAlert ? 'true' : 'false';\n\n// Timestamp\nconst ts = new Date(data.timestamp);\n\n// FORMATO CORRETO para node-red-contrib-influxdb 0.7.0 com InfluxDB 2.0\n// O nÃ³ espera msg.payload como objeto flat com os fields\n// Tags devem estar em msg.payload tambÃ©m\n// measurement e timestamp vÃ£o em propriedades separadas\n\nmsg.payload = {\n    // FIELDS (valores numÃ©ricos)\n    sensor_temp: sensor_temp,\n    sensor_humidity: sensor_humidity,\n    sensor_smoke: sensor_smoke,\n    weather_temp: weather_temp,\n    weather_humidity: weather_humidity,\n    weather_wind: weather_wind,\n    risk_score: risk_score,\n    // TAGS (valores string)\n    device: device,\n    location: location,\n    state: state,\n    region: region,\n    risk_level: risk_level,\n    alert: alert\n};\n\n// Measurement name\nmsg.measurement = 'fire_detection';\n\n// Timestamp em nanosegundos\nmsg.timestamp = ts.getTime() * 1000000;\n\nnode.status({\n    fill: \"blue\",\n    shape: \"dot\",\n    text: `${device}/${state}: Score=${risk_score}`\n});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1020,
        "y": 440,
        "wires": [["influxdb_output", "debug_influx"]]
    },
    {
        "id": "influxdb_output",
        "type": "influxdb out",
        "z": "fire_detection_tab",
        "influxdb": "influxdb_cloud_config",
        "name": "â˜ï¸ InfluxDB Cloud",
        "measurement": "fire_detection",
        "precision": "ns",
        "retentionPolicy": "",
        "database": "",
        "precisionV18FluxV20": "ns",
        "retentionPolicyV18Flux": "",
        "org": "sua_organizacao",
        "bucket": "fire-detection",
        "x": 1290,
        "y": 440,
        "wires": []
    },
    {
        "id": "format_whatsapp",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ“± Formatar Mensagem WhatsApp",
        "func": "const data = msg.payload;\nconst risk = data.risk;\nconst sensor = data.sensor;\nconst weather = data.weather;\nconst location = data.location;\n\nconst message = \n    `${risk.color} *ALERTA DE RISCO DE QUEIMADA: ${risk.level}* ${risk.color}\\n\\n` +\n    `ğŸ”¥ *PONTUAÃ‡ÃƒO DE RISCO: ${risk.score}/100*\\n\\n` +\n    `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n` +\n    `ğŸ“ *LOCALIZAÃ‡ÃƒO*\\n` +\n    `ğŸ™ï¸ Cidade: ${location.city}\\n` +\n    `ğŸ—ºï¸ Estado: ${location.state} (${location.abbr})\\n\\n` +\n    `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n` +\n    `ğŸ“Š *DADOS DO SENSOR IoT*\\n` +\n    `ğŸŒ¡ï¸ Temperatura: ${sensor.temperature.toFixed(1)}Â°C\\n` +\n    `ğŸ’§ Umidade: ${sensor.humidity.toFixed(1)}%\\n` +\n    `ğŸ’¨ FumaÃ§a: ${sensor.smoke.toFixed(0)} ppm\\n` +\n    `ğŸ¤– Dispositivo: ${sensor.device}\\n\\n` +\n    `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n` +\n    `ğŸŒ¦ï¸ *CONDIÃ‡Ã•ES METEOROLÃ“GICAS REAIS*\\n` +\n    `ğŸŒ¡ï¸ Temperatura: ${weather.temperature.toFixed(1)}Â°C\\n` +\n    `ğŸ’§ Umidade: ${weather.humidity.toFixed(1)}%\\n` +\n    `ğŸ’¨ Vento: ${weather.windSpeed.toFixed(1)} km/h\\n` +\n    `â˜ï¸ CondiÃ§Ãµes: ${weather.conditions}\\n\\n` +\n    `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n` +\n    `â° ${new Date().toLocaleString('pt-BR', {timeZone: 'America/Sao_Paulo'})}\\n\\n`;\n\nif (risk.level === 'CRÃTICO') {\n    msg.payload = message + `ğŸš¨ *AÃ‡ÃƒO IMEDIATA NECESSÃRIA!*\\nâš ï¸ Risco extremo de queimada detectado!\\nğŸš’ Acione os bombeiros: 193`;\n} else if (risk.level === 'ALTO') {\n    msg.payload = message + `âš ï¸ *AtenÃ§Ã£o redobrada necessÃ¡ria!*\\nğŸ“ Mantenha contato com autoridades locais`;\n} else {\n    msg.payload = message + `âš ï¸ *Monitoramento contÃ­nuo recomendado*`;\n}\n\nnode.status({\n    fill: \"green\",\n    shape: \"dot\",\n    text: `Enviando alerta ${location.abbr}`\n});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1040,
        "y": 520,
        "wires": [["whatsapp_output", "debug_whatsapp"]]
    },
    {
        "id": "whatsapp_output",
        "type": "node-red-contrib-whatsapp-cmb-send-message",
        "z": "fire_detection_tab",
        "name": "ğŸ“² Enviar WhatsApp",
        "credtype": "account",
        "account": "",
        "text": "payload",
        "phonenumbervalue": "",
        "apikeyvalue": "",
        "apikeyinputtypemessage": "msg",
        "phonenumberinputtypemessage": "msg",
        "inputtypemessage": "msg",
        "rejectssl": false,
        "x": 1290,
        "y": 520,
        "wires": [["debug_whatsapp_response"]]
    },
    {
        "id": "comment_testes",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ§ª TESTES - SimulaÃ§Ã£o Manual (ESP32 + API)",
        "info": "BotÃµes para testar diferentes cenÃ¡rios com 2 devices",
        "x": 200,
        "y": 600,
        "wires": []
    },
    {
        "id": "inject_clear_cache",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸ—‘ï¸ LIMPAR CACHE (antes de testar)",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 640,
        "wires": [["clear_cache_function"]]
    },
    {
        "id": "clear_cache_function",
        "type": "function",
        "z": "fire_detection_tab",
        "name": "ğŸ§¹ Limpar Contexto Global",
        "func": "// Limpar dados antigos do sensor\nglobal.set('sensorData', null);\n\nnode.status({fill:\"green\", shape:\"ring\", text:\"Cache limpo!\"});\nnode.warn(\"âœ… Cache de sensorData limpo com sucesso!\");\n\nreturn null;",
        "outputs": 0,
        "noerr": 0,
        "x": 510,
        "y": 640,
        "wires": []
    },
    {
        "id": "comment_esp32_tests",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ¤– ESP32 Wokwi (Simulado)",
        "info": "Testes com device esp32-wokwi",
        "x": 170,
        "y": 680,
        "wires": []
    },
    {
        "id": "inject_fire_esp32",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸ”¥ ESP32: INCÃŠNDIO CRÃTICO",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"esp32-wokwi\",\"temperature\":55,\"humidity\":20,\"smoke\":750,\"alert\":true}",
        "payloadType": "json",
        "x": 180,
        "y": 720,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "inject_high_esp32",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸŸ  ESP32: Risco ALTO",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"esp32-wokwi\",\"temperature\":42,\"humidity\":35,\"smoke\":450,\"alert\":true}",
        "payloadType": "json",
        "x": 170,
        "y": 760,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "inject_normal_esp32",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸŸ¢ ESP32: CondiÃ§Ãµes NORMAIS",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"esp32-wokwi\",\"temperature\":28,\"humidity\":65,\"smoke\":120,\"alert\":false}",
        "payloadType": "json",
        "x": 200,
        "y": 800,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "inject_auto_esp32",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "â±ï¸ ESP32: Auto (5 min)",
        "props": [{"p": "payload"}],
        "repeat": "300",
        "crontab": "",
        "once": false,
        "onceDelay": "5",
        "topic": "",
        "payload": "{\"device\":\"esp32-wokwi\",\"temperature\":30,\"humidity\":55,\"smoke\":180,\"alert\":false}",
        "payloadType": "json",
        "x": 180,
        "y": 840,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "comment_api_tests",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸŒ API Device (Dados Reais AutomÃ¡ticos)",
        "info": "Coleta dados reais da API a cada 30 segundos",
        "x": 200,
        "y": 900,
        "wires": []
    },
    {
        "id": "inject_auto_api",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "â±ï¸ API: Auto a cada 3 minutos",
        "props": [{"p": "payload"}],
        "repeat": "180",
        "crontab": "",
        "once": true,
        "onceDelay": "3",
        "topic": "",
        "payload": "{\"device\":\"api\",\"temperature\":28,\"humidity\":60,\"smoke\":150,\"alert\":false}",
        "payloadType": "json",
        "x": 200,
        "y": 940,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "comment_api_manual_tests",
        "type": "comment",
        "z": "fire_detection_tab",
        "name": "ğŸ§ª API - Testes Manuais (SituaÃ§Ãµes CrÃ­ticas)",
        "info": "BotÃµes para simular situaÃ§Ãµes extremas",
        "x": 220,
        "y": 1000,
        "wires": []
    },
    {
        "id": "inject_fire_api",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸ”¥ API: INCÃŠNDIO CRÃTICO",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"api\",\"temperature\":52,\"humidity\":18,\"smoke\":800,\"alert\":true}",
        "payloadType": "json",
        "x": 170,
        "y": 1040,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "inject_high_api",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸŸ  API: Risco ALTO",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"api\",\"temperature\":45,\"humidity\":28,\"smoke\":520,\"alert\":true}",
        "payloadType": "json",
        "x": 160,
        "y": 1080,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "inject_normal_api",
        "type": "inject",
        "z": "fire_detection_tab",
        "name": "ğŸŸ¢ API: CondiÃ§Ãµes NORMAIS",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"api\",\"temperature\":26,\"humidity\":70,\"smoke\":95,\"alert\":false}",
        "payloadType": "json",
        "x": 190,
        "y": 1120,
        "wires": [["save_sensor_data"]]
    },
    {
        "id": "debug_analysis",
        "type": "debug",
        "z": "fire_detection_tab",
        "name": "ğŸ” Debug: AnÃ¡lise Completa",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1020,
        "y": 380,
        "wires": []
    },
    {
        "id": "debug_influx",
        "type": "debug",
        "z": "fire_detection_tab",
        "name": "ğŸ” Debug: InfluxDB Data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1520,
        "y": 440,
        "wires": []
    },
    {
        "id": "debug_whatsapp",
        "type": "debug",
        "z": "fire_detection_tab",
        "name": "ğŸ” Debug: WhatsApp Msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1520,
        "y": 520,
        "wires": []
    },
    {
        "id": "debug_whatsapp_response",
        "type": "debug",
        "z": "fire_detection_tab",
        "name": "ğŸ” Debug: WhatsApp Response",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1560,
        "y": 560,
        "wires": []
    },
    {
        "id": "mqtt_broker_hivemq",
        "type": "mqtt-broker",
        "name": "ğŸ HiveMQ Public (Wokwi)",
        "broker": "broker.hivemq.com",
        "port": "1883",
        "clientid": "nodered-fire-detection-multi-state",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "influxdb_cloud_config",
        "type": "influxdb",
        "hostname": "",
        "port": "",
        "protocol": "https",
        "database": "",
        "name": "â˜ï¸ InfluxDB Cloud",
        "usetls": true,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "https://us-east-1-1.aws.cloud2.influxdata.com",
        "timeout": "10000",
        "rejectUnauthorized": true
    }
]
